<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Register for STIF - Sustainability Technology and Innovation Forum">
    <title>Register | STIF - Sustainability Technology and Innovation Forum</title>
    
    <!-- STIF Fonts: Roboto with Montserrat fallback -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    
    <style>
        .auth-page {
            min-height: calc(100vh - 70px);
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding: calc(70px + var(--space-8)) var(--space-6) var(--space-8);
            background: linear-gradient(135deg, var(--primary-50) 0%, white 50%, var(--gray-50) 100%);
        }
        .auth-card {
            width: 100%;
            max-width: 720px;
            background: white;
            border-radius: var(--radius-2xl);
            box-shadow: var(--shadow-xl);
            padding: var(--space-10);
        }
        .auth-header {
            text-align: center;
            margin-bottom: var(--space-8);
        }
        .auth-logo {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            margin-bottom: var(--space-6);
        }
        .auth-title {
            font-size: var(--text-2xl);
            margin-bottom: var(--space-2);
        }
        .auth-subtitle {
            color: var(--gray-500);
            font-size: var(--text-sm);
        }
        .divider {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            margin: var(--space-6) 0;
            color: var(--gray-400);
            font-size: var(--text-sm);
        }
        .divider::before, .divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--gray-200);
        }
        .social-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-3);
            width: 100%;
            padding: var(--space-3) var(--space-4);
            background: white;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            font-weight: 600;
            color: var(--gray-700);
            cursor: pointer;
            transition: all var(--transition);
        }
        .social-btn:hover {
            border-color: var(--gray-300);
            background: var(--gray-50);
        }
        .social-btn svg {
            width: 20px;
            height: 20px;
        }
        .auth-footer {
            text-align: center;
            margin-top: var(--space-6);
            padding-top: var(--space-6);
            border-top: 1px solid var(--gray-100);
        }
        .auth-footer p {
            font-size: var(--text-sm);
            color: var(--gray-500);
            margin-bottom: 0;
        }
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-4);
        }
        .form-section {
            margin-bottom: var(--space-6);
            padding-bottom: var(--space-6);
            border-bottom: 1px solid var(--gray-100);
        }
        .section-title {
            font-size: var(--text-lg);
            font-weight: 600;
            color: var(--primary-700);
            margin-bottom: var(--space-4);
        }
        .subsection-label {
            font-size: var(--text-sm);
            font-weight: 500;
            color: var(--gray-600);
            margin-bottom: var(--space-2);
        }
        .agreement-box {
            background: var(--gray-50);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            margin-bottom: var(--space-4);
        }
        .agreement-box h4 {
            font-size: var(--text-sm);
            margin-bottom: var(--space-2);
        }
        .agreement-box p {
            font-size: var(--text-xs);
            color: var(--gray-500);
            margin-bottom: var(--space-3);
        }
        .success-message {
            text-align: center;
            padding: var(--space-8);
        }
        .success-icon {
            width: 80px;
            height: 80px;
            background: var(--success-bg);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--space-6);
            color: var(--success);
        }
        .required {
            color: #dc2626;
        }
        .form-helper {
            font-size: var(--text-xs);
            color: var(--gray-500);
            margin-top: var(--space-1);
        }
        .password-toggle {
            position: relative;
        }
        .password-toggle .toggle-btn {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: var(--gray-400);
        }
        @media (max-width: 640px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            .auth-card {
                padding: var(--space-6);
            }
        }
    </style>
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="user-type-control.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-inner">
            <a href="/" class="logo">
                <img src="assets/images/logo1.png" alt="STIF Logo" class="logo-img">
                <span class="logo-text">Sustainability Technology and Innovation Forum</span>
            </a>
            
            <nav>
                <ul class="nav-menu">
                    <li><a href="/" class="nav-link">Home</a></li>
                    <li><a href="/about.html" class="nav-link">About</a></li>
                    <li><a href="/faq.html" class="nav-link">FAQ</a></li>
                </ul>
            </nav>
            
            <div class="nav-actions">
                <a href="/champion-login.html" class="btn btn-ghost">Login</a>
                <a href="/champion-register.html" class="btn btn-primary">Get Started</a>
            </div>
            
            <button class="mobile-menu-toggle" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu">
        <button class="mobile-menu-close" aria-label="Close menu">&times;</button>
        <ul class="mobile-nav-menu"></ul>
    </div>

    <!-- Main Content -->
    <main class="auth-page">
        <div class="auth-card animate-fade-in">
            <div class="auth-header">
                <h1 class="auth-title">Become a Champion</h1>
                <p class="auth-subtitle">Join our community of sustainability experts</p>
            </div>

            <!-- Registration Form -->
            <div id="register-form-container">
                <!-- LinkedIn Register -->
                <button type="button" class="social-btn" id="linkedin-btn">
                    <svg viewBox="0 0 24 24" fill="#0A66C2">
                        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                    </svg>
                    Continue with LinkedIn
                </button>

                <div class="divider">or register with email</div>

                <form id="register-form">
                    <!-- Section 1.1: Basic Information -->
                    <div class="form-section">
                        <h2 class="section-title">1.1 Basic Information</h2>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="first_name">First Name <span class="required">*</span></label>
                                <input
                                    type="text"
                                    id="first_name"
                                    name="first_name"
                                    class="form-input"
                                    placeholder="John"
                                    required
                                    maxlength="256"
                                >
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="last_name">Last Name <span class="required">*</span></label>
                                <input
                                    type="text"
                                    id="last_name"
                                    name="last_name"
                                    class="form-input"
                                    placeholder="Doe"
                                    required
                                    maxlength="256"
                                >
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="company">Company/Organization Name <span class="required">*</span></label>
                            <input type="text" id="company" name="company" class="form-input" placeholder="Your Company Ltd" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="job_title">Role/Designation <span class="required">*</span></label>
                            <input type="text" id="job_title" name="job_title" class="form-input" placeholder="Sustainability Manager" required>
                        </div>
                    </div>

                    <!-- Section 1.2: Contact Details -->
                    <div class="form-section">
                        <h2 class="section-title">1.2 Contact Details</h2>
                        
                        <div class="form-group">
                            <label class="form-label" for="email">Business Email <span class="required">*</span></label>
                            <input
                                type="email"
                                id="email"
                                name="email"
                                class="form-input"
                                placeholder="champion@example.com"
                                required
                                autocomplete="email"
                                pattern="^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$"
                                title="Please enter a valid email address (letters, numbers, and . _ % + - only before @)."
                            />
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="mobile_number">Mobile Number <span class="required">*</span></label>
                            <input
                                type="tel"
                                id="mobile_number"
                                name="mobile_number"
                                class="form-input"
                                placeholder="+44 123 456 7890"
                                required
                                inputmode="numeric"
                                pattern="^[0-9]{7,15}$"
                                oninput="this.value = this.value.replace(/\D+/g, ''); this.setCustomValidity('');"
                                oninvalid="this.setCustomValidity('Please enter a valid mobile number using digits only (no spaces or letters), between 7 and 15 digits long.')"
                            >
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="office_phone">Office Phone Number</label>
                            <input
                                type="tel"
                                id="office_phone"
                                name="office_phone"
                                class="form-input"
                                placeholder="+44 123 456 7891"
                                inputmode="numeric"
                                pattern="^[0-9]{7,15}$"
                                oninput="this.value = this.value.replace(/\D+/g, ''); this.setCustomValidity('');"
                                oninvalid="this.setCustomValidity('Please enter a valid office phone number using digits only (no spaces or letters), between 7 and 15 digits long.')"
                            >
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="linkedin_url">LinkedIn Profile</label>
                            <input type="url" id="linkedin_url" name="linkedin_url" class="form-input" placeholder="https://linkedin.com/in/yourprofile">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="website">Professional Website</label>
                            <input type="url" id="website" name="website" class="form-input" placeholder="https://yourwebsite.com">
                        </div>
                    </div>

                    <!-- Section 1.3: ESG Expertise & Achievements -->
                    <div class="form-section">
                        <h2 class="section-title">1.3 ESG Expertise & Achievements</h2>
                        
                        <div class="form-group">
                            <label class="form-label" for="competence_level">Competence in ESG Reporting</label>
                            <select id="competence_level" name="competence_level" class="form-input">
                                <option value="">Select your competence level</option>
                                <option value="beginner">Beginner</option>
                                <option value="intermediate">Intermediate</option>
                                <option value="advanced">Advanced</option>
                                <option value="expert">Expert</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="esg_contributions">Key ESG Contributions</label>
                            <textarea id="esg_contributions" name="esg_contributions" class="form-input" rows="4" placeholder="Highlight impactful projects, reporting experience, or certifications."></textarea>
                        </div>
                    </div>

                    <!-- Section 1.4: Areas of Interest -->
                    <div class="form-section">
                        <h2 class="section-title">1.4 Areas of Interest</h2>
                        
                        <div class="form-group">
                            <label class="form-label subsection-label" for="primary_sector">1.4.1. Primary Sectors of Focus <span class="required">*</span></label>
                            <select id="primary_sector" name="primary_sector" class="form-input" required>
                                <option value="">Select primary sector</option>
                                <option value="agriculture">Agriculture, Forestry & Fishing</option>
                                <option value="automotive">Automotive & Transport</option>
                                <option value="aviation">Aviation & Aerospace</option>
                                <option value="banking">Banking & Financial Services</option>
                                <option value="construction">Construction & Real Estate</option>
                                <option value="creative">Creative Industries (Advertising, Film, Music, Media, etc.)</option>
                                <option value="defense">Defense & Security</option>
                                <option value="education">Education & Training</option>
                                <option value="energy">Energy & Utilities (Renewables, Oil & Gas, Nuclear)</option>
                                <option value="engineering">Engineering & Manufacturing</option>
                                <option value="environmental">Environmental Services</option>
                                <option value="food">Food & Beverage (Production, Retail, Hospitality)</option>
                                <option value="government">Government & Public Services</option>
                                <option value="healthcare">Healthcare & Pharmaceuticals</option>
                                <option value="it">Information Technology (Software Development, Cybersecurity, etc.)</option>
                                <option value="legal">Legal & Professional Services</option>
                                <option value="logistics">Logistics & Supply Chain</option>
                                <option value="marine">Marine & Maritime</option>
                                <option value="mining">Mining & Quarrying</option>
                                <option value="nonprofit">Non-Profit & NGOs</option>
                                <option value="retail">Retail & E-commerce</option>
                                <option value="telecom">Telecommunications</option>
                                <option value="tourism">Tourism, Leisure & Hospitality</option>
                                <option value="transport">Transport & Infrastructure</option>
                                <option value="venture">Venture Capital & Private Equity</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label subsection-label" for="expertise_area">1.4.2. Area of Expertise (Panels) <span class="required">*</span></label>
                            <select id="expertise_area" name="expertise_area" class="form-input" required>
                                <option value="">Select area of expertise</option>
                                <option value="environmental">Environmental (Climate, Energy, Waste, Water)</option>
                                <option value="social">Social (Human Rights, Labor, Community, D&I)</option>
                                <option value="governance">Governance (Ethics, Compliance, Risk, Transparency)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Account Security -->
                    <div class="form-section">
                        <h2 class="section-title">Account Security</h2>
                        
                        <div class="form-group">
                            <label class="form-label" for="password">Password <span class="required">*</span></label>
                            <div class="password-toggle">
                                <input
                                    type="password"
                                    id="password"
                                    name="password"
                                    class="form-input"
                                    placeholder="Min. 8 characters"
                                    required
                                    minlength="8"
                                    autocomplete="new-password"
                                    pattern="^\S(.*\S)?$"
                                    title="Password cannot start or end with a space."
                                >
                                <button type="button" class="toggle-btn" onclick="togglePassword('password')">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                        <circle cx="12" cy="12" r="3"></circle>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="confirm_password">Confirm Password <span class="required">*</span></label>
                            <div class="password-toggle">
                                <input
                                    type="password"
                                    id="confirm_password"
                                    name="confirm_password"
                                    class="form-input"
                                    placeholder="Re-enter your password"
                                    required
                                    minlength="8"
                                    pattern="^\S(.*\S)?$"
                                    title="Password cannot start or end with a space."
                                >
                                <button type="button" class="toggle-btn" onclick="togglePassword('confirm_password')">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                        <circle cx="12" cy="12" r="3"></circle>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Shared error message -->
                        <div class="field-error" id="account-security-error" style="display:none;">
                            The password or confirmation you entered is invalid. Please check and try again.
                        </div>
                    </div>

                <!-- Section 1.5: Legal -->
                <!-- Section 1.5: Legal -->
                <div class="form-section">
                    <h2 class="section-title">1.5 Legal</h2>
                    
                    <label class="form-checkbox mb-4">
                        <input type="checkbox" id="cla_accepted" required>
                        <span>
                            I accept the 
                            <button type="button" class="link-button" data-legal-modal="cla-modal">
                                Contributor License Agreement (CLA)
                            </button>
                            <span class="required">*</span>
                        </span>
                    </label>
                    
                    <label class="form-checkbox mb-4">
                        <input type="checkbox" id="nda_accepted">
                        <span>
                            I have read and agree to the 
                            <button type="button" class="link-button" data-legal-modal="nda-modal">
                                Non-Disclosure Agreement (NDA)
                            </button>
                            <span class="required">*</span>
                        </span>
                    </label>
                    
                    <label class="form-checkbox mb-4">
                        <input type="checkbox" id="terms_accepted" required>
                        <span>
                            I accept the 
                            <button type="button" class="link-button" data-legal-modal="terms-modal">
                                Terms &amp; Conditions
                            </button>
                            <span class="required">*</span>
                        </span>
                    </label>
                    
                    <label class="form-checkbox mb-4">
                        <input type="checkbox" id="ip_accepted">
                        <span>
                            I accept the 
                            <button type="button" class="link-button" data-legal-modal="ip-modal">
                                IP &amp; Attribution Policy
                            </button>
                            (optional if covered in CLA)
                        </span>
                    </label>
                    
                    <!-- Digital Signature (kept at end) -->
                    <div class="form-group">
                        <label class="form-label" for="digital_signature">Digital Signature <span class="required">*</span></label>
                        <input type="text" id="digital_signature" name="digital_signature" class="form-input" placeholder="Type your full name as digital signature" required>
                        <p class="form-helper">By typing your name, you are providing your digital signature</p>
                    </div>
                </div>

                <!-- === LEGAL MODALS === -->
                <style>
                    .legal-modal-backdrop {
                        position: fixed;
                        inset: 0;
                        background: rgba(15, 23, 42, 0.55);
                        display: none;
                        align-items: center;
                        justify-content: center;
                        z-index: 1000;
                    }
                    .legal-modal {
                        background: #fff;
                        max-width: 800px;
                        width: 100%;
                        max-height: 80vh;
                        border-radius: var(--radius-xl, 16px);
                        box-shadow: var(--shadow-2xl, 0 25px 50px -12px rgba(15, 23, 42, 0.25));
                        display: flex;
                        flex-direction: column;
                    }
                    .legal-modal-header {
                        padding: 1rem 1.5rem;
                        border-bottom: 1px solid var(--gray-200, #e5e7eb);
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        gap: 1rem;
                    }
                    .legal-modal-title {
                        font-size: 1rem;
                        font-weight: 600;
                    }
                    .legal-modal-body {
                        padding: 1rem 1.5rem;
                        overflow-y: auto;
                        font-size: 0.875rem;
                        line-height: 1.5;
                    }
                    .legal-modal-footer {
                        padding: 0.75rem 1.5rem 1rem;
                        border-top: 1px solid var(--gray-200, #e5e7eb);
                        display: flex;
                        justify-content: flex-end;
                        gap: 0.75rem;
                    }
                    .legal-close-btn {
                        border: none;
                        background: none;
                        font-size: 1.25rem;
                        cursor: pointer;
                        color: var(--gray-400, #9ca3af);
                    }
                    .btn-tertiary {
                        border-radius: 9999px;
                        padding: 0.4rem 0.9rem;
                        font-size: 0.875rem;
                        border: 1px solid var(--gray-300, #d1d5db);
                        background: #fff;
                        cursor: pointer;
                    }
                    .link-button {
                        background: none;
                        border: none;
                        padding: 0;
                        margin: 0;
                        color: #2563eb;
                        cursor: pointer;
                        text-decoration: underline;
                        font: inherit;
                    }
                    .legal-doc-heading {
                        font-weight: 600;
                        margin-top: 1rem;
                        margin-bottom: 0.25rem;
                    }
                    .legal-doc-meta {
                        font-size: 0.75rem;
                        color: #6b7280;
                        margin-bottom: 0.75rem;
                    }
                    .legal-doc-section-title {
                        font-weight: 600;
                        margin-top: 0.75rem;
                        margin-bottom: 0.25rem;
                    }
                </style>

                <!-- TERMS & CONDITIONS MODAL -->
                <div class="legal-modal-backdrop" id="terms-modal" aria-hidden="true">
                    <div class="legal-modal" role="dialog" aria-modal="true" aria-labelledby="terms-modal-title">
                        <div class="legal-modal-header">
                            <h3 class="legal-modal-title" id="terms-modal-title">STIF Terms and Conditions</h3>
                            <button type="button" class="legal-close-btn" data-legal-close="terms-modal" aria-label="Close Terms &amp; Conditions">&times;</button>
                        </div>
                        <div class="legal-modal-body">
                            <div class="legal-doc-heading">Terms and Conditions</div>
                            <div class="legal-doc-meta">
                                GREENURBS INNOVATION LTD (Company No. 14451676)<br>
                                Effective Date: 21 February 2026 &mdash; Last Updated: 21 February 2026
                            </div>

                            <div class="legal-doc-section-title">1. Introduction</div>
                            <p>These Terms and Conditions ("Terms", "Agreement") govern your use of the STIF platform and associated services operated by GREENURBS INNOVATION LTD ("we", "us", "our", "STIF"). By accessing or using the STIF platform (the "Service"), you agree to be bound by these Terms. If you do not agree with any part of these Terms, you must not use our Service.</p>

                            <div class="legal-doc-section-title">3. Eligibility and Account Registration</div>
                            <p>You must be at least 18 years old and capable of forming a binding contract to use the Service. You are responsible for maintaining the confidentiality of your account credentials and for all activities that occur under your account. You agree to provide accurate, current, and complete information and to update it as necessary.</p>

                            <div class="legal-doc-section-title">4. Services and Licence</div>
                            <p>Subject to your compliance with these Terms and payment of applicable fees, we grant you a limited, non-exclusive, non-transferable, revocable licence to access and use the Service for your internal business purposes only. You must not copy, modify, reverse engineer, or attempt to gain unauthorised access to the Service.</p>

                            <div class="legal-doc-section-title">5. Subscription and Payment</div>
                            <p>Fees are payable in advance for each billing period and are generally non-refundable except as required by law or expressly stated. We reserve the right to change our pricing with notice and may suspend or terminate access for non-payment.</p>

                            <div class="legal-doc-section-title">6. User Content and Conduct</div>
                            <p>You retain ownership of your content but grant STIF a licence to use it to operate and improve the Service. You are responsible for ensuring that your content and use of the Service comply with applicable laws and do not infringe third-party rights or contain unlawful material.</p>

                            <div class="legal-doc-section-title">8. Intellectual Property Rights</div>
                            <p>Except for your own content, all software, frameworks, content, trademarks, logos, and other materials provided through the Service are owned by or licenced to GREENURBS INNOVATION LTD and are protected by intellectual property laws.</p>

                            <div class="legal-doc-section-title">11–13. Disclaimers, Liability and Indemnity</div>
                            <p>The Service is provided "as is" and "as available" without warranties of any kind to the maximum extent permitted by law. Our total liability to you is limited as set out in the full Terms, and you agree to indemnify STIF for losses arising from your misuse of the Service or breach of these Terms.</p>

                            <div class="legal-doc-section-title">15–16. Dispute Resolution and General</div>
                            <p>The Terms are governed by the laws of England and Wales, and the courts of England and Wales have exclusive jurisdiction. The Terms, together with our Privacy and Cookie Policies, form the entire agreement between you and STIF regarding the Service.</p>

                            <p style="margin-top:0.75rem;font-size:0.8rem;color:#6b7280;">
                                This is a summary for convenience only. For full details, please refer to the complete Terms and Conditions in the STIF Legal Documents.
                            </p>
                        </div>
                        <div class="legal-modal-footer">
                            <button type="button" class="btn-tertiary" data-legal-close="terms-modal">Close</button>
                        </div>
                    </div>
                </div>

                <!-- PRIVACY POLICY MODAL (OPTIONAL: if you want easy access here too) -->
                <!-- If you don't want this under 1.5 Legal, you can remove this block. Not tied to a checkbox. -->

                <!-- CLA MODAL -->
                <div class="legal-modal-backdrop" id="cla-modal" aria-hidden="true">
                    <div class="legal-modal" role="dialog" aria-modal="true" aria-labelledby="cla-modal-title">
                        <div class="legal-modal-header">
                            <h3 class="legal-modal-title" id="cla-modal-title">Contributor License Agreement (CLA)</h3>
                            <button type="button" class="legal-close-btn" data-legal-close="cla-modal" aria-label="Close CLA">&times;</button>
                        </div>
                        <div class="legal-modal-body">
                            <div class="legal-doc-heading">Contributor License Agreement (CLA)</div>
                            <div class="legal-doc-meta">
                                Effective Date: 28 February 2026 &mdash; Last Updated: 28 February 2026
                            </div>

                            <div class="legal-doc-section-title">1. Introduction</div>
                            <p>This Contributor License Agreement governs the contributions made by ESG Champions to STIF's ESG framework validation, indicator development, and disclosure refinement processes. By accepting this agreement, you grant STIF the rights described below to use your contributions.</p>

                            <div class="legal-doc-section-title">3. Grant of Copyright Licence</div>
                            <p>You grant STIF a perpetual, worldwide, non-exclusive, royalty-free, irrevocable copyright licence to reproduce, modify, distribute, publicly display, and sublicence your contributions. You retain ownership of your work but allow STIF to incorporate it into its frameworks and materials.</p>

                            <div class="legal-doc-section-title">4. Grant of Patent Licence</div>
                            <p>If your contributions include patentable ideas, you grant STIF a perpetual, worldwide, non-exclusive, royalty-free, irrevocable patent licence to make, use, sell, and otherwise exploit such contributions. This licence may terminate if you bring certain patent claims against STIF.</p>

                            <div class="legal-doc-section-title">5. Representations and Warranties</div>
                            <p>You confirm that you are legally entitled to make contributions, that they are your original work (or properly licensed), and that they do not infringe third-party rights or violate any contractual obligations.</p>

                            <div class="legal-doc-section-title">7. Attribution and Recognition</div>
                            <p>Subject to the ESG Champion ranking system and your preferences, STIF may attribute contributions to you by name and may feature you in community or thought-leadership materials. You can request anonymity or changes to how you are attributed.</p>

                            <div class="legal-doc-section-title">9. Confidentiality and Related Documents</div>
                            <p>You may access confidential information as part of your contribution work and must treat it in accordance with STIF's confidentiality and NDA terms. Contributions are generally voluntary and unpaid unless otherwise agreed in a separate contract.</p>

                            <p style="margin-top:0.75rem;font-size:0.8rem;color:#6b7280;">
                                This is a summary for convenience only. For the full legally binding terms, please refer to the complete Contributor License Agreement in the STIF Legal Documents.
                            </p>
                        </div>
                        <div class="legal-modal-footer">
                            <button type="button" class="btn-tertiary" data-legal-close="cla-modal">Close</button>
                        </div>
                    </div>
                </div>

                <!-- NDA MODAL -->
                <div class="legal-modal-backdrop" id="nda-modal" aria-hidden="true">
                    <div class="legal-modal" role="dialog" aria-modal="true" aria-labelledby="nda-modal-title">
                        <div class="legal-modal-header">
                            <h3 class="legal-modal-title" id="nda-modal-title">Non-Disclosure Agreement (NDA)</h3>
                            <button type="button" class="legal-close-btn" data-legal-close="nda-modal" aria-label="Close NDA">&times;</button>
                        </div>
                        <div class="legal-modal-body">
                            <div class="legal-doc-heading">Non-Disclosure Agreement (NDA)</div>
                            <div class="legal-doc-meta">
                                Effective Date: 28 February 2026 &mdash; Last Updated: 28 February 2026
                            </div>

                            <div class="legal-doc-section-title">1–3. Scope and Confidential Information</div>
                            <p>This NDA covers confidential and proprietary information you may access while acting as an ESG Champion, including unpublished frameworks, methodologies, business and technical information, and any data about business users or other contributors.</p>

                            <div class="legal-doc-section-title">4. Obligations of Confidentiality</div>
                            <p>You must keep all confidential information strictly confidential, use it only for your ESG Champion work with STIF, protect it with reasonable care, and not share it with third parties without STIF's written consent.</p>

                            <div class="legal-doc-section-title">5–6. Required Disclosure and Return of Information</div>
                            <p>If you are legally required to disclose information, you must notify STIF where permitted and disclose only what is required. When your involvement ends, you must return or securely delete confidential materials, except where retention is legally required.</p>

                            <div class="legal-doc-section-title">7–9. Intellectual Property and Term</div>
                            <p>The NDA does not grant you intellectual property rights in STIF's materials. Confidentiality obligations generally survive termination for at least five years or as long as the information remains confidential.</p>

                            <div class="legal-doc-section-title">10–13. Remedies, Liability and Data Protection</div>
                            <p>Unauthorised disclosure may cause irreparable harm; STIF may seek injunctive relief and other remedies. You must handle any personal data you see in line with UK GDPR and STIF's instructions.</p>

                            <p style="margin-top:0.75rem;font-size:0.8rem;color:#6b7280;">
                                This is a summary for convenience only. For full details, please refer to the complete Non-Disclosure Agreement in the STIF Legal Documents.
                            </p>
                        </div>
                        <div class="legal-modal-footer">
                            <button type="button" class="btn-tertiary" data-legal-close="nda-modal">Close</button>
                        </div>
                    </div>
                </div>

                <!-- IP & ATTRIBUTION POLICY MODAL -->
                <div class="legal-modal-backdrop" id="ip-modal" aria-hidden="true">
                    <div class="legal-modal" role="dialog" aria-modal="true" aria-labelledby="ip-modal-title">
                        <div class="legal-modal-header">
                            <h3 class="legal-modal-title" id="ip-modal-title">IP &amp; Attribution Policy</h3>
                            <button type="button" class="legal-close-btn" data-legal-close="ip-modal" aria-label="Close IP &amp; Attribution Policy">&times;</button>
                        </div>
                        <div class="legal-modal-body">
                            <div class="legal-doc-heading">IP and Attribution Policy</div>
                            <div class="legal-doc-meta">
                                Effective Date: 28 February 2026 &mdash; Last Updated: 28 February 2026
                            </div>

                            <div class="legal-doc-section-title">2. Ownership of Contributions</div>
                            <p>You retain ownership of the copyright and other IP rights in your original contributions. However, once submitted, your contributions become part of STIF frameworks under a licence that allows STIF to use, modify, and distribute them as described in the CLA.</p>

                            <div class="legal-doc-section-title">3. Attribution Rights</div>
                            <p>STIF may credit you in framework contributor lists, on your ESG Champion profile, and in thought-leadership or community materials. You can request anonymity, control profile visibility, or opt out of certain uses of your name and likeness.</p>

                            <div class="legal-doc-section-title">4. Moral Rights</div>
                            <p>To the extent permitted by law, you waive moral rights in your contributions so that STIF can edit, adapt, combine, or use them without needing additional approvals and without always providing attribution.</p>

                            <div class="legal-doc-section-title">5–7. Name, Likeness and Confidential Contributions</div>
                            <p>With your participation, STIF may use your name, likeness, and professional details to recognise your contributions. Contributions to unpublished frameworks remain confidential under the NDA until publicly released.</p>

                            <div class="legal-doc-section-title">8–11. Disputes, Trademarks and Duration</div>
                            <p>Attribution decisions are ultimately made by STIF, though you can raise concerns. STIF trademarks remain owned by GREENURBS INNOVATION LTD. The IP rights you grant are perpetual and continue even if you stop participating as an ESG Champion.</p>

                            <p style="margin-top:0.75rem;font-size:0.8rem;color:#6b7280;">
                                This is a summary for convenience only. For full details, please refer to the complete IP and Attribution Policy in the STIF Legal Documents.
                            </p>
                        </div>
                        <div class="legal-modal-footer">
                            <button type="button" class="btn-tertiary" data-legal-close="ip-modal">Close</button>
                        </div>
                    </div>
                </div>

                <script>
                // Simple open/close logic for legal modals
                document.addEventListener('click', (event) => {
                    const openTarget = event.target.closest('[data-legal-modal]');
                    if (openTarget) {
                        const id = openTarget.getAttribute('data-legal-modal');
                        const modal = document.getElementById(id);
                        if (modal) {
                            modal.style.display = 'flex';
                            modal.setAttribute('aria-hidden', 'false');
                        }
                    }

                    const closeTarget = event.target.closest('[data-legal-close]');
                    if (closeTarget) {
                        const id = closeTarget.getAttribute('data-legal-close');
                        const modal = document.getElementById(id);
                        if (modal) {
                            modal.style.display = 'none';
                            modal.setAttribute('aria-hidden', 'true');
                        }
                    }

                    // click on backdrop closes
                    if (event.target.classList.contains('legal-modal-backdrop')) {
                        event.target.style.display = 'none';
                        event.target.setAttribute('aria-hidden', 'true');
                    }
                });

                // ESC key closes any open modal
                document.addEventListener('keydown', (event) => {
                    if (event.key === 'Escape') {
                        document.querySelectorAll('.legal-modal-backdrop').forEach(m => {
                            if (m.style.display === 'flex') {
                                m.style.display = 'none';
                                m.setAttribute('aria-hidden', 'true');
                            }
                        });
                    }
                });
                </script>

                    <div id="error-message" class="alert alert-error hidden" style="margin-bottom: var(--space-4);"></div>

                    <button type="submit" class="btn btn-primary w-full" id="submit-btn">
                        Register as Champion
                    </button>
                </form>

                <div class="auth-footer">
                    <p>Already have an account? <a href="/champion-login.html">Sign in</a></p>
                </div>
            </div>

            <!-- Success Message -->
            <div id="success-container" class="success-message hidden">
                <div class="success-icon">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                </div>
                <h2>Check Your Email</h2>
                <p class="text-secondary">We've sent a confirmation link to <strong id="confirm-email"></strong>. Please click the link to verify your account.</p>
                <a href="/champion-login.html" class="btn btn-primary mt-6">Go to Login</a>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <a href="/" class="logo">
                        <img src="assets/images/logo1.png" alt="STIF Logo" class="logo-img-footer">
                        <span class="logo-text">Sustainability Technology and Innovation Forum</span>
                    </a>
                    <p class="footer-description">
                        Empowering sustainability experts to validate and improve ESG practices worldwide.
                    </p>
                    <div class="footer-social">
                        <a href="#" aria-label="LinkedIn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
                                <rect x="2" y="9" width="4" height="12"></rect>
                                <circle cx="4" cy="4" r="2"></circle>
                            </svg>
                        </a>
                        <a href="#" aria-label="X">
                            <!-- X (formerly Twitter) icon -->
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path>
                            </svg>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h6 class="footer-title">Platform</h6>
                    <ul class="footer-links">
                        <li><a href="/about.html" class="footer-link">About Us</a></li>
                        <li><a href="/faq.html" class="footer-link">FAQ</a></li>
                    </ul>
                </div>
                
                <div>
                    <h6 class="footer-title">Support</h6>
                    <ul class="footer-links">
                        <li><a href="/terms.html" class="footer-link">Terms of Service</a></li>
                        <li><a href="/privacy.html" class="footer-link">Privacy Policy</a></li>
                        <li><a href="/cookie-policy.html" class="footer-link">Cookie Policy</a></li>
                    </ul>
                </div>
                
                <div class="footer-action">
                    <h6 class="footer-title">Contact Us</h6>
                    <a href="https://calendly.com/stiforum-info/30min" class="btn btn-primary" target="_blank" rel="noopener">
                        Contact
                    </a>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>
                &copy; <span id="current-year"></span>
                STIF - Sustainability Technology and Innovation Forum. All rights reserved.
                </p>
                <p>Built with purpose for a sustainable future.</p>
            </div>
        </div>
    </footer>

<script src="footer-year.js"></script>

    <!-- Scripts -->
    <!-- Services -->
    <script src="supabase-service.js"></script>
    <script src="champion-auth-supabase.js"></script>
    <script src="dynamic-navigation.js"></script>
    <script src="mobile-menu.js"></script>
    <script src="logout.js"></script>
    
    <script>
        // Toggle password visibility
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            input.type = input.type === 'password' ? 'text' : 'password';
        }

        // LinkedIn register
        document.getElementById('linkedin-btn').addEventListener('click', async () => {
            try {
                const result = await window.championAuth.loginWithLinkedIn();
                if (!result.success) {
                    showError(result.error);
                }
            } catch (error) {
                showError('LinkedIn registration failed. Please try again.');
            }
        });

        // Email registration form
        document.getElementById('register-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Validate passwords match
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirm_password').value;
            
            if (password !== confirmPassword) {
                showError('Passwords do not match');
                return;
            }
            
            // Check for invitation token in URL
            const urlParams = new URLSearchParams(window.location.search);
            const inviteToken = urlParams.get('invite') || urlParams.get('token');
            
            const formData = {
                first_name: document.getElementById('first_name').value,
                last_name: document.getElementById('last_name').value,
                full_name: `${document.getElementById('first_name').value} ${document.getElementById('last_name').value}`,
                company: document.getElementById('company').value,
                job_title: document.getElementById('job_title').value,
                mobile_number: document.getElementById('mobile_number').value,
                office_phone: document.getElementById('office_phone').value,
                linkedin_url: document.getElementById('linkedin_url').value,
                website: document.getElementById('website').value,
                competence_level: document.getElementById('competence_level').value,
                esg_contributions: document.getElementById('esg_contributions').value,
                primary_sector: document.getElementById('primary_sector').value,
                expertise_area: document.getElementById('expertise_area').value,
                cla_accepted: document.getElementById('cla_accepted').checked,
                nda_accepted: document.getElementById('nda_accepted').checked,
                terms_accepted: document.getElementById('terms_accepted').checked,
                ip_accepted: document.getElementById('ip_accepted').checked,
                digital_signature: document.getElementById('digital_signature').value,
                invite_token: inviteToken // Pass invitation token if present
            };
            
            const email = document.getElementById('email').value;
            const submitBtn = document.getElementById('submit-btn');
            
            // Disable button
            submitBtn.disabled = true;
            submitBtn.textContent = 'Creating account...';
            hideError();
            
            try {
                const result = await window.championAuth.register(email, password, formData);
                
                if (result.success) {
                    // Handle invitation acceptance and notify inviter
                    if (inviteToken && result.data?.user?.id) {
                        await handleInvitationAcceptance(inviteToken, result.data.user.id, formData.full_name);
                    }
                    
                    // Show success message
                    document.getElementById('register-form-container').classList.add('hidden');
                    document.getElementById('success-container').classList.remove('hidden');
                    document.getElementById('confirm-email').textContent = email;
                } else {
                    showError(result.error);
                }
            } catch (error) {
                showError('An unexpected error occurred. Please try again.');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Register as Champion';
            }
        });

        /**
         * Handle invitation acceptance - update invitation status and notify inviter
         */
        async function handleInvitationAcceptance(token, newUserId, newUserName) {
            try {
                const client = window.getSupabase?.();
                if (!client) return;

                // Find the invitation
                const { data: invitation, error } = await client
                    .from('invitations')
                    .select('id, invited_by, email')
                    .eq('token', token)
                    .eq('status', 'pending')
                    .single();

                if (error || !invitation) {
                    console.log('No valid invitation found for token');
                    return;
                }

                // Update invitation status
                await client
                    .from('invitations')
                    .update({ status: 'accepted' })
                    .eq('id', invitation.id);

                // Send notification to the inviter
                if (invitation.invited_by && window.supabaseService?.createNotification) {
                    await window.supabaseService.createNotification(
                        invitation.invited_by,
                        'peer_joined',
                        'Your Peer Joined! 🎉',
                        `${newUserName || 'A peer'} accepted your invitation and joined STIF!`,
                        '/champion-dashboard.html',
                        { 
                            new_user_id: newUserId,
                            new_user_name: newUserName
                        }
                    );
                    console.log('Peer joined notification sent to inviter');
                }
            } catch (err) {
                console.warn('Error handling invitation acceptance:', err);
            }
        }

        function showError(message) {
            const errorEl = document.getElementById('error-message');
            errorEl.textContent = message;
            errorEl.classList.remove('hidden');
        }

        function hideError() {
            document.getElementById('error-message').classList.add('hidden');
        }

        // Check if already logged in
        document.addEventListener('DOMContentLoaded', async () => {
            await new Promise(resolve => setTimeout(resolve, 500));
            if (window.championAuth.isAuthenticated()) {
                window.location.href = '/champion-dashboard.html';
            }
        });
    </script>
</body>
</html>
